---
layout: post
title:  "Notes on quantum walk and quantum simulated annealing"
categories: quantum
tags: note textbook-reading quantum-walk
author: wyj
date:   2020-06-05 17:30:00 -0700
---

These are notes on quantum walk and quantum simulated annealing, mainly based on:

- Sec III of [Lecture Notes on Quantum Algorithms by Andrew Childs](https://www.cs.umd.edu/~amchilds/qa/)
  - Chapter 16: Continuous-time quantum walk (read) (note-taken)
  - Chapter 17: Discrete-time quantum walk (to-read) (note-taken)
- Quantum algorithms for simulated annealing (arXiv: 1512.03806) (read)
- Quantum simulations of classical annealing processes (arXiv: 0804.1571) (read)
- Quantum simulations of classical random walks and undirected graph connectivity (arXiv: cs/9812012) (partially-read) (note-taken)
- Spectral gap amplification (arXiv: 1110.2494) (to-read)
- Quantum walk algorithm for element distinctness (arXiv: 0311001) (to-read)
- Quantum speed-up of Markov chain based Algorithms (to-read)
- Search via quantum walk (arXiv: 0608026) (to-read)
- Quantum search by measurement (arXiv: 0204013) (to-read)
- Exponential algorithmic speedup by quantum walk (arXiv: 0209131) (to-read)

## Table of contents
- [16 Continuous-time quantum walk](#16-continuous-time-quantum-walk)
  * [16.1 Continuous-time quantum walk](#161-continuous-time-quantum-walk)
    + [Classical continuous-time random walk](#classical-continuous-time-random-walk)
    + [The quantum analog](#the-quantum-analog)
    + [Recap](#recap)
  * [16.2 Random and quantum walks on the hypercube](#162-random-and-quantum-walks-on-the-hypercube)
  * [16.3 Random and quantum walks in one dimension](#163-random-and-quantum-walks-in-one-dimension)
  * [16.4 Black-box traversal of the glued trees graph](#164-black-box-traversal-of-the-glued-trees-graph)
  * [16.5 Quantum walk algorithm to traverse the glued trees graph](#165-quantum-walk-algorithm-to-traverse-the-glued-trees-graph)
  * [16.6 Classical and quantum mixing](#166-classical-and-quantum-mixing)
    + [Understanding the spectrum of A](#understanding-the-spectrum-of-a)
  * [16.7 Classical lower bound](#167-classical-lower-bound)
- [17 Discrete-time quantum walk](#17-discrete-time-quantum-walk)
  * [17.1 Discrete-time quantum walk](#171-discrete-time-quantum-walk)
  * [17.2 How to quantize a Markov chain](#172-how-to-quantize-a-markov-chain)
  * [17.3 Spectrum of the quantum walk](#173-spectrum-of-the-quantum-walk)
  * [17.4 Hitting times](#174-hitting-times)
- [Quantum simulations of classical random walks and undirected graph connectivity](#quantum-simulations-of-classical-random-walks-and-undirected-graph-connectivity)


## 16 Continuous-time quantum walk


### 16.1 Continuous-time quantum walk

> It is easiest to define a quantum analog of a continuous-time random walk

#### Classical continuous-time random walk
Adjacency matrix \\(A\\) & Laplacian \\(L\\): as you know

> The continuous-time random walk on G is defined as the solution of the differential equation
\\(\frac{d}{dt} p_j (t) = \sum_{k\in V} L_{jk} p_k (t)\\)

The evolution for any time \\(t\\) is a *stochastic processes* (normalization preserved) since the columns of L sum to \\(0\\).

#### The quantum analog

Compared to the Schrodinger equation:
\\(i\frac{d}{dt}\|\psi\rangle=H\|\psi\rangle\\)

Let \\(q_j(t)=\langle j\|\psi(t)\rangle\\) be quantum amplitudes. The equation is

\\(i\frac{d}{dt}q_j(t)=\sum_{k\in V} L_{jk} q_k(t)\\).

Normalization preserved since Laplacian is Hermitian.

Solution: \\(\|\psi(t)\rangle=e^{-iLt} \|\psi(0)\rangle\\)

Note: Any Hermitian Hamiltonian that represents the structure of \\(G\\) can be used.

#### Recap

| classical continuous-time random walk | Schrodinger equation | the quantum analog |
| :---: | :---: | :---: |
| \\(\frac{d}{dt} p_j (t) = \sum_{k\in V} L_{jk} p_k (t)\\) | \\(i\frac{d}{dt}\|\psi\rangle=H\|\psi\rangle\\) | \\(i\frac{d}{dt}q_j(t)=\sum_{k\in V} L_{jk} q_k(t)\\) |


### 16.2 Random and quantum walks on the hypercube

The Boolean hypercube: as you know.

<img src="https://github.com/Raycosine/raycosine.github.io/blob/master/_images/hypercube.jpg?raw=true" width="30%" style="margin: auto 0;">

The adjacency matrix is \\(A=\sum_{j=1}^n \sigma_x^{j}\\)

When \\(G\\) is regular, \\(L=A+deg* I\\), the walk generated by \\(L\\) have an overall phase \\(e^{-i\ deg\ t}\\) compared to the one generated by \\(A\\).

The probability of reaching the opposite vertex starting from a vertex is exponentially small at any time, since the walk rapidly (\\(t=\pi/2\\)) reaches the uniform distribution over all vertices.

### 16.3 Random and quantum walks in one dimension

The graph: an infinite path, unweighted

The eigenstates of \\(L\\): momentum states \\(\|\hat{p}\rangle\\) with components \\(\langle j\| \hat{p}\rangle=e^{ipj}\\).

I don't know Bessel function..I like vegetables so much...

The continuous-time classical random walk and the quantum analog have dramatically different behaviors.

### 16.4 Black-box traversal of the glued trees graph

The glued trees graph: two balanced binary trees of height \\(n\\) (should refer to full binary tree, since # vertices is \\(2^{n+1}-1\\)?) joined by a random cycle of length \\(2\times 2^n\\) that alternates between the leaves of the two trees. Denote the trees as \\(A\\) and \\(B\\), leaves as \\(L_{Ai}\\) and \\(L_{Bi}\\). The random cycle would be in this form: \\(L_{Ai}, L_{Bj}, L_{Ak}, L_{Bm}, ...\\).

Classical walk: 

hard to reach the root on the opposite side starting from one root.

Quantum walk: 

> produces a state with a overlap lower bounded by \\(1/poly(n)\\) on the other root, in a amount of time upper bounded by \\(poly(n)\\).

### 16.5 Quantum walk algorithm to traverse the glued trees graph

Strategy:

> simply to run the quantum walk and show that the resulting state has a substantial overlap on the \\(EXIT\\) for some \\(t=poly(n)\\).

Definitions:

ENTRANCE / EXIT: the root of the left / right tree.

Basis of states, uniform superpositions over the vertices on the same layer: \\(\|col j\rangle := \frac{!}{\sqrt{N_j}} \sum_{\delta(a, ENTRANCE)=j} \|a\rangle\\). (\\(N_j\\): # of all vertices satisfying \\(\delta(a, ENTRANCE)=j\\))

Easy to find \\(A\|col j\rangle\\).

This walk starting from \\(ENTRANCE\\) is effectively the same as a quantum walk on a weighted path of \\(2n+2\\) (slightly different from 16.3's case)

To prove that this walk reaches the \\(EXIT\\) in poly time, see the notion of *mixing time* of a quantum walk in the next subsection.

### 16.6 Classical and quantum mixing

Informal definition:

> The mixing time of a random walk is the amount of time it takes to come close to a stationary distribution. 

\\(u:=(1,1,...,1)/\|V\|\\) is the eigenvector of \\(L\\) with eigenvalue \\(0\\).


If \\(G\\) is connected, \\(u\\) is the only eigenvector with eigenvalue 0.

Use the spectral decomposition of \\(L\\). In \\(p(t)\\), terms of eigenvectors with non-zero eigenvalues will decrease exponentially in time and then the walk asymptotically approaches the uniform distribution (\\(u\\)). Hence the inverse of the largest nonzero eigenvalue of \\(L\\) determines the "convergence" speed.

\\(p_{a\rightarrow b} (T)=\sum_\lambda \| \langle a\| \lambda\rangle \langle b\|\lambda \rangle \|^2 + \sum_{\lambda\neq \lambda^\prime} \langle b\|\lambda\rangle \langle \lambda \| a\rangle \langle a\|\lambda^\prime\rangle \langle \lambda^\prime \|b\rangle \frac{1-e^{-i(\lambda-\lambda^\prime)T}}{i(\lambda-\lambda^\prime)T}\\)

Roughly speaking, since we expect \\(\|(\lambda-\lambda^\prime)T\|>>1\\), \\(T>>\frac{1}{\|\lambda-\lambda^\prime\|}\\)

Limiting distribution:

> A Limiting Distribution (also called an asymptotic distribution) is the hypothetical distribution — or convergence — of a sequence of distributions. As it is hypothetical, it isn't a distribution in the general sense of the word. (from [here](https://www.statisticshowto.com/limiting-distribution/#:~:text=A%20Limiting%20Distribution%20(also%20called,general%20sense%20of%20the%20word.))

> Since a quantum walk is a unitary process, we should not expect it to approach a limiting quantum state, no matter how long we wait. Nevertheless, it is possible to deﬁne a notion of the limiting distribution of a quantum walk...

? why does it say that \\(T\\) need to be large compared to the smallest gap between a particular pair of eigenvalues in the classical case? 

"The mixing time of the quantum walk is \\(poly(n)\\)" is proven by Cauchy-Schwarz inequality.

Formally speaking, the "distance" between the probability of reaching \\(EXIT\\) starting from \\(ENTRANCE\\) within time \\(T\\), \\(p_{ENTRANCE\rightarrow EXIT}(T)\\), and the limiting value \\(p_{ENTRANCE\rightarrow EXIT}(\infty)\\), can be written as:

\\(\|(p_{ENTRANCE\rightarrow EXIT}(\infty)-(p_{ENTRANCE\rightarrow EXIT}(T)\|\leq\frac{2}{\Delta T}\\), where \\(\Delta\\) denotes the smallest gap between any pair of distinct eigenvalues of \\(A\\).

? Why do we need to lower bound \\(\Delta\\)?

#### Understanding the spectrum of A

Recall that for any \\(p\\), the state \\(\|\lambda\rangle\\) with amplitudes \\(\langle col j\|\lambda\rangle = e^{ipj}\\) satisfies \\(\langle col j\|A\|\lambda\rangle =\lambda \langle col j\|\lambda\rangle\\), where \\(\lambda=2\sqrt{2} \cos{p}\\) for all values of \\(j\\) except \\(0,n,n+1,2n+1\\). The eigenvalue condition (\\(\langle col j\|A\|\lambda\rangle =\lambda \langle col j\|\lambda\rangle\\)) for \\(j=0,2n+1, n, n+1\\) can be satisfied by replacing \\(\|\lambda\rangle\\) by linear combination of \\(\{\|\lambda\rangle\}\\) previously used. And then we obtain (16.51)~(16.53).

(Spielman was one of the authors of quant-ph/0209131...orz)

? Does \\(T=5n/\Delta\\) only apply to the n=4 case?

### 16.7 Classical lower bound

Solving (A or B) is hard --> solving A is hard

? In the first step, is \\(n\\) considered while talking about "exponentially many more possible names" and "exponentially small probability"? The number of possible names seems to be just approximately the square of \\(\|V\|\\).

## 17 Discrete-time quantum walk

> provides a convenient framework for quantum search algorithms

### 17.1 Discrete-time quantum walk

To move in the same way as discrete-time classical walk, the transformation of the quantum walk would be nonunitary, which could be fixed by using an enlarged Hilbert space (spanned by \\(\{\|j,k\rangle: (j,k)\in E\}\\), "a walker at vertex \\(j\\) that will move toward vertex \\(k\\)), more precisely, using an ancillary "coin flip" register.

See next section for detail.

(Hmm..sounds similar to clock register used in some gadgets of the local Hamiltonian problem...)

A single step of the quantum walk:
> 1. We apply a unitary transformation that operates on the second register conditional on the ﬁrst register
> 2. The walker is moved to the vertex indicated in the second register

? SWAP the only way to make step 2 unitary?

### 17.2 How to quantize a Markov chain

> A more convenient framework introduced by Szegedy \[94\] (not-read)

At least by now I can't see any difference between this section and \[96\]...

In the first paragraph, \\(P_{jk}\\) should be \\(P_{kj}\\) instead.

A single step of the quantum walk: \\(U:= S(2\Pi-1)\\), where \\(\Pi\\) is the projection onto span{\\(\|\psi_j\rangle\\)} and \\(S\\) is the swap operator (see [the following paper-reading section](#quantum-simulations-of-classical-random-walks-and-undirected-graph-connectivity)).

### 17.3 Spectrum of the quantum walk

Define:

\\(D\\): \\(N*N\\) matrix, \\(D_{jk} = \sqrt{P_{jk} P_{kj}}\\) with eigenvalues \\(\{\lambda\}\\).

\\(T\\): an isometry, \\(T:=\sum_{j=1}^N \|\psi_j\rangle \langle j\|\\).

\\(\|\tilde{\lambda}\rangle\\): \\(T\|\lambda\rangle\\). 

\\(TT^\dagger, T^\dagger T, T^\dagger ST\\) are equal to \\(\Pi, I, D\\) respectively.

Then we can notice that some of \\(U\\)'s eigenvectors lie within span{\\(\|\tilde{\lambda}\rangle, S\|\tilde{\lambda}\rangle\\)}.

### 17.4 Hitting times

Problem: to decide whether any vertex in G is marked.

Modify the walk by reordering the vertices (unmarked first, marked second).

The remaining as you know.

## Quantum simulations of classical random walks and undirected graph connectivity

This paper was cited as \[96\] in [17.1](#171-discrete-time-quantum-walk) of Childs' notes. I only read *3 Quantum operators* to better understand [17](#17-discrete-time-quantum-walk) and concepts in the first two simulate annealing papers as listed above.

Definitions (copied from the original source):

The graph \\(G=(V,E)\\), undirected & regular of degree \\(d\\).

\\(n=\|V\|, m=\|E\|\\)

\\(\forall u\in V, S(u)=\{v\in V: \{u,v\} \in E\}, B(u)=S(u) \cup \{u\}.\\)

The "diffusion" operator in quantum walk:

| transformation  | unitary representation | "diffusion" operator in Grover's searching algorithm |
| :---: | :---: | :---: |
| \\(F\|u,v\rangle=\|u,v\rangle-\frac{2}{d+1} \sum_{v^\prime \in B(u)} \|u,v^\prime\rangle (v\in B(u)), \|u,v\rangle (v\notin B(u))\\) | \\(F=I-2\sum_{u\in V} \|\psi_u\rangle\langle \psi_u \|\\) | \\(D\|a\rangle=\|a\rangle -\frac{2}{d+1} \sum_{b=0}^d \|b\rangle\\) |

\\(\|u,v\rangle\\) could sometimes be taken as \\(\|u\rangle\otimes\|v\rangle\\), just like [17.1](#171-discrete-time-quantum-walk).

\\(\|\psi_u\rangle=\frac{1}{\sqrt{d+1}}\sum_{v\in B_u} \|u,v\rangle\\)

In [17.1](#171-discrete-time-quantum-walk), only \\(\{v:v\in S_u\}\\) are considered, and \\(F\\) is defined as 

\\(C:=\sum_{j\in V} \|j\rangle\langle j\| \otimes (2\|\partial j\rangle\langle \partial j\|-I)\\), where \\(\|j\rangle \otimes \|\partial j\rangle\\) is the analog of \\(\|\psi_u\rangle\\).

Also, we need swap operator \\(X=\sum_{u,v\in V} \|v,u\rangle\langle u,v\| \\) and projection \\(P=\sum_{u\in V} \|u,u\rangle\langle u,u\|\\).

Then a single step of quantum walk is \\(Q=PFXFP\\). See lemma 3 for the proof that after a large number of steps starting from \\(u\\), the distribution would be close to the uniform distribution on \\(S(u)\\).
